<!DOCTYPE html>
<html>
<head>
    <title>GPTunes</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    
    <div class="header">
        <div style="width: 17%;border-right: 2px solid #ffffff;">
            <h1>GPTunes</h1> 
        </div>

        <div class="button-container">
            <a href="/" class="navigation-button" style="border-left: 2px solid #ffffff;"><button class="navigation-button">Lyrics</button></a>
            <a href="/album-embedding" class="navigation-button"><button class="navigation-button">Album embedding</button></a>
        </div>
    </div>
    
    <div class="grid-container">
    
        <div class="left-column">
            <form action="/search-albums" method="GET">
                <input type="text" name="query-album-1" placeholder="Search album 1"
                       class="search-bar" value="{{ album_1_name }}">
                <input type="text" name="query-album-2" placeholder="Search album 2"
                       class="search-bar" value="{{ album_2_name }}">
                <button class="other-button" style="float:left;">Search</button>
                <p style="float:left;padding-left:10px;margin:auto;padding-top:10px;">Search status: {{ search_status }}</p>
            </form>
            <div style="float:left;width:100%;margin-top:5px;">
                <form action="/make-lyric-embedding" style="width:35%;float:left;">
                    <button id="make-lyric-embedding-button" class="other-button">Make lyric embedding</button>
                </form>
                <form action="/make-music-embedding" style="width:40%;float:left;">
                    <button id="make-music-embedding-button" class="other-button">Make music embedding</button>
                </form>
            </div>
        </div>
        
        <div></div>
        
        <div>
            <h2>Lyric embedding</h2>
            <p>These are the embeddings from the lyrics of the songs of the
               two albums. Of course, this means that only some of the style
               of the artist and album is captured, since the audio is not used.
               However, it is still interesting to see how the lyrics of the
               songs of the two albums are clustered. After generating the 
               embeddings, UMAP is applied to reduce their dimensionality.</p>
        </div>

        <div>
            <h2>Music embedding</h2>
            <p>These embeddings are generated by a model that is trained on
               the actual audio of songs. It is therefore better able to take
               into account the style of the music, but it is also more difficult
               for these embeddings to take account themes or topics in the music
               (something that the previous embeddings are better at). It should
               also be noted that these embeddings are made from a 30 second
               preview of the song, which may not be representative for the
               whole song.<p>
        </div>

        <div id="image-lyric-container"></div>
        <div id="image-music-container"></div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#make-lyric-embedding-button').click(function(e) {
                $('#make-lyric-embedding-button').text("Loading embedding...");
                e.preventDefault();
                $.ajax({
                    url: '/make-lyric-embedding',
                    type: 'POST',
                    success: function(response) {
                        var imgElement = document.createElement('img');
                        imgElement.src = 'static/images/tsne.png';
                        imgElement.id = 'tsne-image';
                        var imageContainer = document.getElementById('image-lyric-container');
                        imageContainer.appendChild(imgElement);
                        $('#make-lyric-embedding-button').text("Make lyric embedding");
                    }
                });
          });
        });

        $('#make-music-embedding-button').click(function(e) {
            $('#make-music-embedding-button').text("Loading embedding...");
            e.preventDefault();
            $.ajax({
                url: '/make-music-embedding',
                type: 'POST',
                success: function(response) {
                    if (response['status'] == "error") {
                        var errorParagraph = document.createElement('p');
                        errorParagraph.textContent = "One of the albums does not have previews.";
                        var imageContainer = document.getElementById('image-music-container');
                        imageContainer.appendChild(errorParagraph);
                        $('#make-music-embedding-button').text("Make lyric embedding");
                        return;
                    }
                    var imgElement = document.createElement('img');
                    imgElement.src = 'static/images/music_embedding.png';
                    imgElement.id = 'tsne-image';
                    var imageContainer = document.getElementById('image-music-container');
                    imageContainer.appendChild(imgElement);
                    $('#make-music-embedding-button').text("Make lyric embedding");
                }
            });
        });

    </script>

</body>
</html>
